<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>Facebook Login Callback</title>
	<style>
		body {
			font-family: sans-serif;
			display: flex;
			align-items: center;
			justify-content: center;
			height: 100vh;
			background: #f2f2f2;
		}

		.container {
			background: white;
			padding: 30px;
			border-radius: 12px;
			box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
			text-align: center;
			width: 350px;
		}

		.spinner {
			width: 40px;
			height: 40px;
			border: 4px solid #ccc;
			border-top-color: #1877f2;
			border-radius: 50%;
			animation: spin 1s linear infinite;
			margin: 20px auto;
		}

		@keyframes spin {
			from {
				transform: rotate(0);
			}

			to {
				transform: rotate(360deg);
			}
		}
	</style>
</head>

<body>
	<div class="container">
		<h2>Đang đăng nhập bằng Facebook...</h2>
		<div class="spinner"></div>
		<p>Vui lòng chờ trong giây lát...</p>
	</div>

	<script>
		(async () => {
			// 1. Lấy code từ URL (ví dụ: ?code=xxxxxxx)
			const params = new URLSearchParams(window.location.search);
			const code = params.get("code");
			const state = params.get("state");

			if (!code) {
				alert("Không nhận được code từ Facebook!");
				return;
			}

			try {
				// 2. Gửi code về backend để đổi token
				const res = await fetch("https://your-backend.com/auth/facebook/callback", {
					method: "POST",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify({ code, state })
				});

				const data = await res.json();

				if (!res.ok) {
					alert("Lỗi đăng nhập Facebook: " + data.message);
					return;
				}
				localStorage.setItem("token", data.token);

				window.location.href = "/home.html";

			} catch (err) {
				console.error(err);
				alert("Có lỗi xảy ra khi xác thực Facebook!");
			}
		})();
	</script>
</body>

</html>